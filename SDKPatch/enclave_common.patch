diff --git a/psw/enclave_common/sgx_enclave_common.cpp b/psw/enclave_common/sgx_enclave_common.cpp
index ca881a4f..b218ce8b 100644
--- a/psw/enclave_common/sgx_enclave_common.cpp
+++ b/psw/enclave_common/sgx_enclave_common.cpp
@@ -820,6 +820,25 @@ extern "C" void* COMM_API enclave_create_ex(
     
     if (enclave_error != NULL)
         *enclave_error = ENCLAVE_ERROR_SUCCESS;
+
+    // mmap elrange guard page
+    uint64_t elrange_guard_size = 0x1000 /* one page */;
+    if ((MAP_FAILED == mmap((void *)((uint64_t)enclave_base - elrange_guard_size), elrange_guard_size, PROT_NONE, MAP_FIXED | MAP_ANONYMOUS | MAP_PRIVATE, -1, 0)) ||
+        (MAP_FAILED == mmap((void *)((uint64_t)enclave_base + virtual_size), elrange_guard_size, PROT_NONE, MAP_FIXED | MAP_ANONYMOUS | MAP_PRIVATE, -1, 0)))
+    {
+        SE_TRACE(SE_TRACE_WARNING, "ElrangeGuard unavailable, errno = %d\n", errno);
+        if (enclave_error != NULL)
+        {
+            *enclave_error = ENCLAVE_UNEXPECTED;
+        }
+        if (s_driver_type == SGX_DRIVER_IN_KERNEL)
+        {
+            close_file(&hdevice_temp);
+        }
+        munmap(enclave_base, virtual_size);
+        return NULL;
+    };
+
     return enclave_base;
 }
 

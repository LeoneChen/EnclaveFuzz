diff --git a/scripts/ghidra_run.sh b/scripts/ghidra_run.sh
index 588d52d..cc62ef5 100755
--- a/scripts/ghidra_run.sh
+++ b/scripts/ghidra_run.sh
@@ -23,7 +23,7 @@ TARGET="$(realpath $2)"  # original target input (tested with basic ELF file loa
 SCRIPT="$(realpath $3)"  # script to run
 
 BIN=$GHIDRA_ROOT/support/analyzeHeadless
-PROJDIR=$WORKDIR/traces/ghidra
+PROJDIR=$WORKDIR/../ghidra$(echo ${TARGET}|sed "s@/@_@g")
 PROJ=cov_analysis
 
 test -d $PROJDIR   || mkdir $PROJDIR || fail "Could not create target folder $PROJDIR"
@@ -33,7 +33,7 @@ test -f "$SCRIPT"  || fail "Could not find coverage analysis script at $SCRIPT"
 
 # Check if traces have been generated and optionally create unique edges file
 test -d "$WORKDIR/traces/" || fail "Could not find traces/ folder in workdir."
-test -f "$WORKDIR/traces/edges_uniq.lst" || $KAFL_ROOT/tools/unique_edges.sh $WORKDIR
+test -f "$WORKDIR/traces/edges_uniq.lst" || $KAFL_ROOT/fuzzer/scripts/unique_edges.sh $WORKDIR
 
 # TODO: how can we hand the file argument directly to ghidra script?
 ln -sf "$WORKDIR/traces/edges_uniq.lst" /tmp/edges_uniq.lst
diff --git a/scripts/unique_edges.sh b/scripts/unique_edges.sh
index 40341b0..f9229c5 100755
--- a/scripts/unique_edges.sh
+++ b/scripts/unique_edges.sh
@@ -37,7 +37,7 @@ for trace in ./payload_*.lz4; do
 done
 
 echo -n "Sorting final output..."
-sort -u $TMPFILE |sed -e 's/.*\[//' -e 's/\].*//' > $OUTFILE
+sort $TMPFILE |sed -e 's/.*\[//' -e 's/\].*//'|uniq -c|sed 's/\ /,/g'|awk -F ',+' '{print $3","$4","$2}' > $OUTFILE
 rm $TMPFILE
 echo -e "done!\nGot $(wc -l $OUTFILE) edges in $OUTFILE"
 

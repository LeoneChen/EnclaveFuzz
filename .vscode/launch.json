{
    // Use IntelliSense to learn about possible attributes.
    // Hover to view descriptions of existing attributes.
    // For more information, visit: https://go.microsoft.com/fwlink/?linkid=830387
    "version": "0.2.0",
    "configurations": [
        {
            "name": "(gdb) Attach",
            "type": "cppdbg",
            "request": "attach",
            "program": "${workspaceFolder}/kAFL/kafl/qemu/x86_64-softmmu/qemu-system-x86_64",
            "MIMode": "gdb",
            "setupCommands": [
                {
                    "description": "Enable pretty-printing for gdb",
                    "text": "-enable-pretty-printing",
                    "ignoreFailures": true
                },
                {
                    "description": "Set Disassembly Flavor to Intel",
                    "text": "-gdb-set disassembly-flavor intel",
                    "ignoreFailures": true
                },
                {
                    "text": "handle SIGUSR1 nostop",
                }
            ]
        },
        {
            "name": "filter_crashes.py",
            "type": "python",
            "request": "launch",
            "program": "/home/leone/Documents/linux-sgx/SGXSan/Tool/filter_crashes.py",
            "console": "integratedTerminal",
            "justMyCode": true,
            "args": [
                "-b",
                "./app",
                "-c",
                "./result/crashes",
                "--extra-opt=-max_len=10000000 --cb_max_size=4096 --cb_max_count=8 --cb_max_strlen=4096 --cb_modify_double_fetch_value_prob=0.05 --cb_modify_ocall_ret_prob=0.05"
            ],
            "cwd": "/home/leone/Documents/linux-sgx/SGX_APP/sgx-dnet"
        },
        {
            "name": "sgx-edger8r",
            "type": "ocaml.earlybird",
            "request": "launch",
            "program": "${workspaceFolder}/ThirdParty/edger8r/_build/install/default/bin/edger8r",
            "arguments": [
                "--untrusted",
                "test.edl",
                "--search-path",
                "/home/leone/EnclaveFuzz/install/enclave_fuzz/include",
                // "--typeinfo-dir",
                // "/home/leone/EnclaveFuzz/SGX_APP/TaLoS/",
                // "--include-path",
                // "../include/",
                "--gen-harness",
                // "--max-depth",
                // "2"
            ],
            "cwd": "${workspaceFolder}/ThirdParty/edger8r/test",
        },
        {
            "name": "(libSGXFuzzerPass) Launch",
            "type": "cppdbg",
            "request": "launch",
            "program": "/home/leone/Documents/llvm-project/install/bin/clang",
            "args": [
                "-m64",
                "-O0",
                "-g",
                "-fPIC",
                "-Wno-attributes",
                "-Wno-implicit-function-declaration",
                "-flegacy-pass-manager",
                "-Xclang",
                "-load",
                "-Xclang",
                "../../../../../SGXSan/install/lib64/libSGXFuzzerPass.so",
                "-mllvm",
                "--max-depth-recursively-prepare-pointer=6",
                "-Xclang",
                "-load",
                "-Xclang",
                "../../../../../SGXSan/install/lib64/libGetOCallTable.so",
                "-Xclang",
                "-load",
                "-Xclang",
                "../../../../../SGXSan/install/lib64/libSGXSanPass.so",
                "-mllvm",
                "-in-enclave=false",
                "-DDEBUG",
                "-UNDEBUG",
                "-UEDEBUG",
                "-I../include",
                "-I../../../../../SGXSan/install/include",
                "-c",
                "enclave_u.c",
                "-o",
                "enclave_u.o",
            ],
            "stopAtEntry": false,
            "cwd": "${workspaceFolder}/SGX_APP/TaLoS/src/libressl-2.4.1/crypto",
            "environment": [],
            "externalConsole": false,
            "MIMode": "gdb",
            "setupCommands": [
                {
                    "description": "Enable pretty-printing for gdb",
                    "text": "-enable-pretty-printing",
                    "ignoreFailures": true
                },
                {
                    "description": "Set Disassembly Flavor to Intel",
                    "text": "-gdb-set disassembly-flavor intel",
                    "ignoreFailures": true
                },
                {
                    "text": "-gdb-set follow-fork-mode child"
                }
            ]
        },
        {
            "name": "(SGXSan) Launch",
            "type": "cppdbg",
            "request": "launch",
            "program": "/home/leone/llvm-project/install/bin/clang++",
            "args": [
                "-fvisibility=hidden",
                "-fpie",
                "-fstack-protector",
                "-IInclude",
                "-IEnclave",
                "-IEnclave/romulus",
                "-IEnclave/romulus/romuluslog",
                "-I/home/leone/SGXSan/install_dir/DEBUG-LIBFUZZER-install/include",
                "-I/home/leone/SGXSan/install_dir/DEBUG-LIBFUZZER-install/include/tlibc",
                "-I/home/leone/SGXSan/install_dir/DEBUG-LIBFUZZER-install/include/libcxx",
                "",
                "-m64",
                "-O2",
                "-Wall",
                "-Wextra",
                "-Winit-self",
                "-Wpointer-arith",
                "-Wreturn-type",
                "-Waddress",
                "-Wsequence-point",
                "-Wformat-security",
                "-Wmissing-include-dirs",
                "-Wfloat-equal",
                "-Wundef",
                "-Wshadow",
                "-Wcast-align",
                "-Wcast-qual",
                "-Wconversion",
                "-Wredundant-decls",
                "-Wnon-virtual-dtor",
                "-std=c++11",
                "-fno-discard-value-names",
                "-flegacy-pass-manager",
                "-Xclang",
                "-load",
                "-Xclang",
                "/home/leone/SGXSan/install_dir/DEBUG-LIBFUZZER-install/lib64/libSGXSanPass.so",
                "-fsanitize-coverage=inline-8bit-counters,bb,no-prune,pc-table,trace-cmp",
                "-fprofile-instr-generate",
                "-fcoverage-mapping",
                "-c",
                "Enclave/Enclave.cpp",
                "-o",
                "Enclave/Enclave.o"
            ],
            "stopAtEntry": false,
            "cwd": "/home/leone/SGXSan/SGX_APP/plinius",
            "environment": [],
            "externalConsole": false,
            "MIMode": "gdb",
            "setupCommands": [
                {
                    "description": "Enable pretty-printing for gdb",
                    "text": "-enable-pretty-printing",
                    "ignoreFailures": true
                },
                {
                    "description": "Set Disassembly Flavor to Intel",
                    "text": "-gdb-set disassembly-flavor intel",
                    "ignoreFailures": true
                },
                {
                    "text": "-gdb-set follow-fork-mode child"
                }
            ]
        },
        {
            "name": "TestApp",
            "type": "cppdbg",
            "request": "launch",
            "program": "${workspaceFolder}/workdir/WAMR/Fuzzer2/TestApp",
            "args": [
                // "./result/seeds",
                // "-artifact_prefix=./result/crashes/",
                "./result/crashes/crash-0a2a19ce08cd1f95bbca024b568f6f6c29b083c7",
                "-max_len=1000000",
                // "-verbosity=2",
                // "--cb_max_count=8",
                // "--cb_log_level=4",
                // "--cb_provide_nullptr=true",
                // "--cb_provide_nullptr_probability=0",
                // "-fork=1",
                // "-ignore_crashes=1",
                // SampleSGXSan
                // "--cb_max_count=4096",
                // "-max_len=100000000",
                // "--cb_filter_out=ecall_producer,ecall_consumer",
                // SGX_SQLite
                // "-max_len=10000000",
                // "--cb_zoom_rate=5",
                // "--cb_max_count=8",
                // "--cb_log_level=4",
                // "--cb_provide_nullptr=true",
                // "--cb_provide_nullptr_probability=0",
                // sgx-dnet
                // "-max_len=10000000",
                // "--cb_max_count=8",
                // "--cb_max_size=4096",
                // "--cb_max_strlen=4096",
                // "--cb_modify_double_fetch_value_prob=0.05",
                // "--cb_modify_ocall_ret_prob=0.05"
                // "--cb_enable_collect_stack=true",
                // "--cb_use_addr2line=true"
                // sgxssl
                // "--cb_return0_probability=0.5"
                // SwitchlessSGXSan
                // "--cb_max_count=8",
                // "-max_len=10000000",
                // "--cb_filter_out=sl_run_switchless_tworker,sl_init_switchless",
                // "--cb_log_level=4",
                // "--cb_provide_nullptr=false",
                // "-max_total_time=2",
                // wolfssl
                // "-max_len=1000000",
                // "--cb_not_modify_ocall_ret=/untrusted/ocall_current_time/parameter/0"
                // libressl
                // "-max_len=10000000",
                // "--cb_max_count=4096",
                // "--cb_max_size=4096",
                // "--cb_max_strlen=4096",
                // "--cb_ecall_queue_size=5",
                // "--cb_modify_double_fetch_value_prob=0.05",
                // "--cb_modify_ocall_ret_prob=0.05",
                // "--cb_zoom_rate=12"
                // mbedtls-SGX
                // "-max_len=10000000",
                // "--cb_zoom_rate=2",
            ],
            "stopAtEntry": false,
            "cwd": "${workspaceFolder}/workdir/WAMR/Fuzzer2",
            "environment": [],
            "externalConsole": false,
            "MIMode": "gdb",
            "setupCommands": [
                {
                    "description": "Enable pretty-printing for gdb",
                    "text": "-enable-pretty-printing",
                    "ignoreFailures": true
                },
                {
                    "description": "Set Disassembly Flavor to Intel",
                    "text": "-gdb-set disassembly-flavor intel",
                    "ignoreFailures": true
                }
            ]
        },
        {
            "name": "kafl fuzz",
            "type": "python",
            "request": "launch",
            "program": "/home/leone/Documents/SGXSan3/kAFL/kafl/.venv/bin/kafl",
            "args": [
                "fuzz",
                "-w",
                "/home/leone/Documents/SGXSan3/kAFL/kafl/examples/linux-user/example/workdir",
                "--kernel",
                "/boot/vmlinuz-5.10.73-kafl+",
                "--initrd",
                "/home/leone/Documents/SGXSan3/kAFL/kafl/examples/linux-user/example/example.cpio.gz",
                "--memory",
                "512",
                "--sharedir",
                "/home/leone/Documents/SGXSan3/kAFL/kafl/examples/linux-user/example/sharedir",
                "--seed-dir",
                "/home/leone/Documents/SGXSan3/kAFL/kafl/examples/linux-user/example/seeds",
                "-p",
                "1",
                "--redqueen",
                "--grimoire",
                "--radamsa",
                "-D",
                "--funky",
                "--purge",
                "--log-hprintf",
                "-R",
                "1",
            ],
            "env": {
                "KAFL_CONFIG_FILE": "/home/leone/Documents/SGXSan3/kAFL/kafl/examples/linux-user/example/kafl.yaml"
            },
            "console": "integratedTerminal",
            "justMyCode": true,
        },
        {
            "name": "(kAFL) Launch",
            "type": "cppdbg",
            "request": "launch",
            "program": "${workspaceFolder}/SGX_APP/ehsm/out/ehsm-core/ehsm_core_test",
            "args": [],
            "stopAtEntry": true,
            "cwd": "${workspaceFolder}",
            "environment": [],
            "externalConsole": false,
            "MIMode": "gdb",
            // "miDebuggerPath": "/opt/intel/sgxsdk/bin/sgx-gdb",
            "setupCommands": [
                {
                    "description": "Enable pretty-printing for gdb",
                    "text": "-enable-pretty-printing",
                    "ignoreFailures": true
                },
                {
                    "description": "Set Disassembly Flavor to Intel",
                    "text": "-gdb-set disassembly-flavor intel",
                    "ignoreFailures": true
                },
                {
                    "text": "handle SIGILL nostop",
                }
            ],
            "hardwareBreakpoints": {
                "require": true,
            },
            "miDebuggerServerAddress": "localhost:5555"
        },
    ]
}